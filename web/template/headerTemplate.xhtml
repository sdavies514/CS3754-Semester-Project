<?xml version="1.0" encoding="UTF-8"?>
<!--
Created by Casey Butenhoff on 2017.11.18
Copyright Â© 2017 Casey Butenhoff. All rights reserved.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <!--
    *********************************************
    * Header Component of Template siteTemplate *
    *********************************************
    This page's content is displayed on the top of each page created based on the siteTemplate.
    Changes made in this file will show up automatically with all pages created based on the
    siteTemplate for the entire site, achieving great maintainability.
    -->

    <!-- Do not enter tags before the composition line since they are ignored by JSF -->
    <ui:composition>
        <h:form>

            <table border="0" cellspacing="0" cellpadding="10" width="100%">
                <tr>
                    <td align="left" valign="middle">

                        <!-- Use absolute path for the image file since it will be accessed from all pages -->
                        <h:link outcome="/index"><img src="#{resource['images:thoughtwareLogo.png']}"
                                                      style="width:100%; height:100%; max-height:64px; max-width:150px; border: none"
                                                      alt="Company Logo" />
                        </h:link>

                    </td>
                    <!-- Welcome the user if signed in -->
                    <td align="center" valign="middle">

                        <c:if test="#{accountManager.isLoggedIn() == true}">
                            <h1>Hello, #{accountManager.selected.firstName}</h1>
                        </c:if>
                        <c:if test="#{accountManager.isLoggedIn() == false}">
                            <h1>Hello, Guest</h1>
                        </c:if>

                    </td>
                    <td align="right" valign="middle">
                        
                        <!-- Collect header site links into a PrimeFaces menubar. -->
                        <p:menubar style="width: 475px">
                            <!-- Clicking "Home" displays the index.xhtml file -->
                            <p:menuitem value="Home" outcome="/index" styleClass="arialTen" icon="fa fa-home" />
                            
                            <!-- Create My Projects dynamic menu for user if signed in -->
                            <c:if test="#{accountManager.isLoggedIn() == true}">
                                <p:submenu label="My Projects" icon="ui-icon-bookmark">
                                    
                                    <!-- projectController.userItems holds a collection of Project objects
                                            for which the Project object's corresponding UserProjectAssociations 
                                            in ThoughtwareDB have a user_id corresponding to the signed in user.
                                            projectController.userItems must be updated within ProjectController
                                            whenever a Project is joined by the user. -->
                                    <c:forEach items="#{projectController.userItems}" var="proj">
                                        <!-- Create a submenu in My Projects for each Project belonging to the user. -->
                                        <p:submenu label="#{proj.name}">
                                            <!-- Clicking these menu items below each Project will redirect user to
                                                    ViewProject.xhtml, ViewProjectFiles.xhtml, or MilestoneCalendar.xhtml.
                                                    Notice that it is necessary to pass proj, the Project object reference,
                                                    to the projectViewManager's corresponding redirect method, to update
                                                    the actively 'selected' Project for site-wide use. -->
                                            <p:menuitem value="Project Home" action="#{projectViewManager.showProjectHome(proj)}"  />
                                            <!--<p:menuitem value="Timeline" action="#{projectViewManager.showProjectTimeline(proj)}" />-->
                                            <p:menuitem value="Files" action="#{projectViewManager.showProjectFiles(proj)}" />
                                            <p:menuitem value="Calendar" action="#{projectViewManager.showProjectCalendar(proj)}" /> 
                                        </p:submenu>
                                    </c:forEach>
                                </p:submenu>
                                
                                <!-- Display "My Account" if a user is signed in; redirect to Profile.xhtml -->
                                <p:menuitem value="My Account" outcome="/Profile" styleClass="arialTen" icon="fa fa-user" />
                                
                                <!-- Display "Projects" if a user is signed in; redirect to ListProject.xhtml
                                        to display the list of all Projects (and ability to create/join Projects -->
                                <p:menuitem value="Projects" outcome="/ListProject" styleClass="arialTen" icon="fa fa-tasks" />
                                
                                <!-- Display "Sign Out" if a user is signed in; call accountManager to logout -->
                                <f:facet name="options">
                                    <p:commandButton value="Sign Out" action="#{accountManager.logout()}" 
                                                     styleClass="commandButton" icon="fa fa-sign-out" />
                                </f:facet>
                            </c:if>
                            
                            <!-- "Sign In" and "Create an Account" if no user is signed in -->
                            <c:if test="#{accountManager.isLoggedIn() == false}">
                                <!-- Clicking "Sign In" displays the SignIn.xhtml file -->
                                <p:menuitem value="Sign In" outcome="/SignIn" styleClass="arialTen" icon="fa fa-sign-in" />
                                
                                <!-- Clicking "My Account" displays the Profile.xhtml file -->
                                <p:menuitem value="Create an Account" outcome="/CreateAccount" styleClass="arialTen" icon="fa fa-user-plus" />
                            </c:if>
                        </p:menubar>
                    </td>
                </tr>
            </table>

        </h:form>

    </ui:composition>
    <!-- Do not enter tags before the composition line since they are ignored by JSF -->

</html>
